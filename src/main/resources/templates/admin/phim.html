<!DOCTYPE html>
<html  xmlns:th="http://www.thymeleaf.org">
<head th:replace="admin/layout/head :: head">

</head>
<body class="hold-transition skin-blue sidebar-mini ">
<!-- Site wrapper -->
<div class="wrapper">

    <header th:replace="admin/layout/header :: header"></header>
    <!-- =============================================== -->

    <!-- Left side column. contains the sidebar -->
    <aside th:replace="admin/layout/aside :: aside"></aside>
    <!-- =============================================== -->

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <section class="content-header">
            <h1>
                Quản lý phim

            </h1>
            <ol class="breadcrumb">
                <li><a href="#" th:href="@{/quantri}"><i class="fa fa-dashboard"></i> Home</a></li>
            </ol>
        </section>

        <!-- Main content -->
        <section class="content">

            <!-- Default box -->
            <div class="col-xs-12">
                <div class="box">
                    <div class="box-header">
                        <a href="#" th:href="@{/quantri/add-phim}" class="btn btn-success">Thêm mới phim</a>

                        <div class="box-tools">
                            <form>
                                <div class="input-group input-group-sm" style="width: 150px;">
                                    <input type="text" name="key" class="form-control pull-right" placeholder="Search" th:value="${key}">

                                    <div class="input-group-btn">
                                        <button type="submit" class="btn btn-default"><i class="fa fa-search"></i></button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body table-responsive no-padding">
                        <table class="table table-hover table-bordered">
                            <tbody><tr>
                                <th>Mã bộ phim</th>
                                <th>Tên phim</th>
                                <th>Đạo diễn</th>
                                <th>Diễn viên</th>
                                <th>Ngôn nghữ</th>
                                <th>Thời lượng</th>
                                <th>Trailer</th>
                                <th>Ảnh</th>
                                <th>Ngày hiệu lực từ</th>
                                <th>Ngày hiệu lực đến</th>
                                <th>Thể loại phim</th>
                                <th>Trạng thái</th>
                                <th>Tùy chọn</th>
                            </tr>
                            <tr th:each="phim : ${phims}">
                                <td th:text="${phim.id}"></td>
                                <td th:text="${phim.tenPhim}"></td>
                                <td th:text="${phim.daoDien}"></td>
                                <td th:text="${phim.dienVien}"></td>
                                <td th:text="${phim.ngonNghu}"></td>
                                <td th:text="${phim.thoiLuong}"></td>
                                <td >
                                    <button type="button" class="btn btn-primary" data-toggle="modal" th:attr="data-target='#videoModal' + ${phim.id}">
                                        Xem Trailer
                                    </button>
                                </td>
                                <td ><img th:src="@{'../uploads/' + ${phim.anh}}" width="120px" height="100px"></td>
                                <td th:text="${#dates.format(phim.ngayHieuLucTu, 'dd/MM/yyyy')}"></td>
                                <td th:text="${#dates.format(phim.ngayHieuLucDen, 'dd/MM/yyyy')}"></td>
                                <td th:text="${phim.theLoai}"></td>
                                <td th:if="${phim.trangThai}">hien</td>
                                <td th:if="${!phim.trangThai}">an</td>
                                <td>
                                    <a th:href="@{/quantri/update-phim(id=${phim.id})}" class="btn btn-success">Sửa</a>
                                    <a th:href="@{/quantri/delete-phim(id=${phim.id})}" class="btn btn-danger"
                                       onclick="return confirm('Bạn có chắc chắn muốn xóa phim này không')">Xóa</a>
                                </td>
                            </tr>

                            </tbody></table>
                    </div>

                    <ul class="pagination pagination-sm no-margin pull-right">
                        <li th:if="${currentPage > 1}">
                            <a th:href="@{/quantri/phim(page=${currentPage - 1}, key=${key})}">&laquo;</a>
                        </li>
                        <li th:each="pageNum : ${#numbers.sequence(currentPage > 2 ? currentPage - 2 : 1, currentPage + 2 > totalPages ? totalPages : currentPage + 2)}"
                            th:classappend="${pageNum == currentPage} ? 'active'">
                            <a th:href="@{/quantri/phim(page=${pageNum}, key=${key})}" th:text="${pageNum}"></a>
                        </li>
                        <li th:if="${currentPage < totalPages}">
                            <a th:href="@{/quantri/phim(page=${currentPage + 1}, key=${key})}">&raquo;</a>
                        </li>
                        <li th:if="${totalPages > 5 && currentPage < totalPages - 2}">
                            <a th:href="@{/quantri/phim(page=${totalPages}, key=${key})}">&raquo;&raquo;</a>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- /.box -->
            <div th:each="phim : ${phims}" th:attr="data-target='videoModal' + ${phim.id}">
                <div class="modal fade" th:id="'videoModal' + ${phim.id}" role="dialog">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">Video</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <video width="570px" controls>
                                    <source th:src="@{'../uploads/' + ${phim.video}}" type="video/mp4">
                                    Your browser does not support the video tag.
                                </video>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- /.box -->

        </section>
        <!-- /.content -->
    </div>
    <!-- /.content-wrapper -->

    <footer th:replace="admin/layout/footer :: footer"></footer>

</div>
<!-- ./wrapper -->

<!-- jQuery 3 -->
<div th:replace="admin/layout/script :: script"></div>
</body>
</html>